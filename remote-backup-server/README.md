# üß∞ Offsite Backup Setup Scripts

–¶–µ–π –Ω–∞–±—ñ—Ä —Å–∫—Ä–∏–ø—Ç—ñ–≤ –¥–æ–ø–æ–º–æ–∂–µ —à–≤–∏–¥–∫–æ –ø—ñ–¥–≥–æ—Ç—É–≤–∞—Ç–∏ Raspberry Pi –∞–±–æ –±—É–¥—å-—è–∫–∏–π Linux-–ø—Ä–∏—Å—Ç—Ä—ñ–π —è–∫ **–æ—Ñ—Å–∞–π—Ç-—Å—Ö–æ–≤–∏—â–µ –¥–ª—è –±–µ–∫–∞–ø—ñ–≤**.  
–°–∫—Ä–∏–ø—Ç–∏ –≤–∏–∫–æ–Ω—É—é—Ç—å –ø–æ–≤–Ω—É –ø—ñ–¥–≥–æ—Ç–æ–≤–∫—É ‚Äî –≤—ñ–¥ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –¥–∏—Å–∫—É –¥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è VPN-—Ç—É–Ω–µ–ª—é —á–µ—Ä–µ–∑ **Tailscale** —ñ NAT-–ø—Ä–æ–∫—Å—ñ –¥–ª—è –¥–æ—Å—Ç—É–ø—É –∑ –ª–æ–∫–∞–ª—å–Ω–æ—ó –º–µ—Ä–µ–∂—ñ.

---

## ‚öôÔ∏è –°–∫—Ä–∏–ø—Ç–∏

| ‚Ññ | –ù–∞–∑–≤–∞ | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è |
|---|--------|--------------|
| **0_setup_disc.sh** | –§–æ—Ä–º–∞—Ç—É—î SSD / HDD, —Å—Ç–≤–æ—Ä—é—î —Ñ–∞–π–ª–æ–≤—É —Å–∏—Å—Ç–µ–º—É `ext4`, –º–æ–Ω—Ç—É—î –¥–∏—Å–∫ —ñ –¥–æ–¥–∞—î –∑–∞–ø–∏—Å —É `/etc/fstab`. |
| **1_setup_rsync_service.sh** | –í—Å—Ç–∞–Ω–æ–≤–ª—é—î —Ç–∞ –Ω–∞–ª–∞—à—Ç–æ–≤—É—î **rsyncd** –¥–ª—è –ø—Ä–∏–π–æ–º—É –±–µ–∫–∞–ø—ñ–≤, —Å—Ç–≤–æ—Ä—é—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –π –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é —Å–µ—Ä–≤—ñ—Å—É. |
| **2_setup_tailscale.sh** | –í—Å—Ç–∞–Ω–æ–≤–ª—é—î **Tailscale**, –ø—ñ–¥–∫–ª—é—á–∞—î –ø—Ä–∏—Å—Ç—Ä—ñ–π –¥–æ Tailnet —ñ –≤–º–∏–∫–∞—î –±–µ–∑–ø–µ—á–Ω–∏–π –¥–æ—Å—Ç—É–ø –ø–æ VPN. |
| **3_setup_lxc_router.sh** | –ù–∞–ª–∞—à—Ç–æ–≤—É—î **Tailscale-—à–ª—é–∑ (NAT)** —É LXC –¥–ª—è –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü—ñ—ó –∑–∞–ø–∏—Ç—ñ–≤ `rsync` —É –≤—ñ–¥–¥–∞–ª–µ–Ω—É –º–µ—Ä–µ–∂—É. |

---

## üöÄ –ü–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è

### –Ø–∫—â–æ –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —Ç–æ –¥–æ–¥–∞–π—Ç–µ curl –ø–∞–∫–µ—Ç

```bash
sudo apt update && sudo apt install -y curl
```

### 1Ô∏è‚É£ –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∏—Å–∫—É

–§–æ—Ä–º–∞—Ç—É—î–º–æ –¥–∏—Å–∫ —ñ –º–æ–Ω—Ç—É—î–º–æ –π–æ–≥–æ –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –±–µ–∫–∞–ø—ñ–≤:
```bash
bash <(curl -sL https://raw.githubusercontent.com/ravado/homeserver/main/offsite-backup/0_setup_disc.sh)
```

---

### 2Ô∏è‚É£ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è rsync-—Å–µ—Ä–≤—ñ—Å—É

–ù–∞–ª–∞—à—Ç–æ–≤—É—î–º–æ –ø—Ä–∏–π–æ–º –±–µ–∫–∞–ø—ñ–≤ —á–µ—Ä–µ–∑ `rsyncd`:
```bash
bash <(curl -sL https://raw.githubusercontent.com/ravado/homeserver/main/offsite-backup/1_setup_rsync_service.sh)
```

---

### 3Ô∏è‚É£ –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ VPN (Tailscale)

–ü—ñ–¥–∫–ª—é—á–∞—î–º–æ –ø—Ä–∏—Å—Ç—Ä—ñ–π –¥–æ Tailnet, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å—Ç–∞–±—ñ–ª—å–Ω–∏–π –≤—ñ–¥–¥–∞–ª–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø:
```bash
bash <(curl -sL https://raw.githubusercontent.com/ravado/homeserver/main/offsite-backup/2_setup_tailscale.sh)
```

---

### 4Ô∏è‚É£ (–û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ) –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞ —É Proxmox

–Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ, —â–æ–± **–ª–æ–∫–∞–ª—å–Ω–∞ –º–µ—Ä–µ–∂–∞ –±–∞—á–∏–ª–∞ rsync-—Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ VPN**, –∑–∞–ø—É—Å—Ç—ñ—Ç—å —Ü–µ–π —Å–∫—Ä–∏–ø—Ç —É LXC-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ:
```bash
bash <(curl -sL https://raw.githubusercontent.com/ravado/homeserver/main/offsite-backup/3_setup_lxc_router.sh)
```

---

## üß© –ö–æ—Ä–∏—Å–Ω—ñ –∫–æ–º–∞–Ω–¥–∏

| –ó–∞–≤–¥–∞–Ω–Ω—è | –ö–æ–º–∞–Ω–¥–∞ |
|-----------|----------|
| –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∑–º–æ–Ω—Ç–æ–≤–∞–Ω—ñ –¥–∏—Å–∫–∏ | `lsblk` |
| –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ Tailscale-—Å—Ç–∞—Ç—É—Å | `tailscale status` |
| –î—ñ–∑–Ω–∞—Ç–∏—Å—è IP-–∞–¥—Ä–µ—Å—É | `tailscale ip -4` |
| –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ—Å—Ç—å rsync | `nc -zv <ip> 873` |
| –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ NAT-–ø—Ä–∞–≤–∏–ª–∞ | `sudo iptables -t nat -L -n -v` |

---

## üß† –ü—Ä–∏–º—ñ—Ç–∫–∏

- –°–∫—Ä–∏–ø—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –ø—Ä–∞–≤ `sudo` —ñ –Ω–µ –∑–º—ñ–Ω—é—é—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ñ —Ñ–∞–π–ª–∏ –±–µ–∑ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è.  
- –Ø–∫—â–æ –ø—Ä–∏—Å—Ç—Ä—ñ–π –±—É–¥–µ –ø–µ—Ä–µ–≤–µ–∑–µ–Ω–æ –≤ —ñ–Ω—à–µ –º—ñ—Å—Ü–µ, –ø—Ä–æ—Å—Ç–æ –ø—ñ–¥–∫–ª—é—á—ñ—Ç—å –π–æ–≥–æ –¥–æ Wi-Fi ‚Äî **Tailscale –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤—ñ–¥–Ω–æ–≤–∏—Ç—å –∑‚Äô—î–¥–Ω–∞–Ω–Ω—è**.  
- –î–ª—è LXC —É Proxmox –¥–æ–¥–∞–π—Ç–µ –¥–æ `/etc/pve/lxc/<ID>.conf`:
  ```bash
  lxc.cgroup2.devices.allow: c 10:200 rwm
  lxc.mount.entry: /dev/net/tun dev/net/tun none bind,create=file
  ```

---

üì∫ **–ê–≤—Ç–æ—Ä:** [–î–æ–º–∞—à–Ω—ñ–π –°–µ—Ä–≤–µ—Ä](https://www.youtube.com/@homeserver)  
üí¨ **–ü—Ä–æ—î–∫—Ç:** https://github.com/ravado/homeserver  